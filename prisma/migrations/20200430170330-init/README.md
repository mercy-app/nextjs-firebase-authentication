# Migration `20200430170330-init`

This migration has been generated by I Chen Wu at 4/30/2020, 5:03:30 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Platform.typeSlug"

ALTER TABLE "public"."Category" DROP CONSTRAINT IF EXiSTS "Category_platformId_fkey",
DROP COLUMN "name",
ADD COLUMN "title" text  NOT NULL ,
ALTER COLUMN "platformId" DROP NOT NULL;

ALTER TABLE "public"."Platform" DROP COLUMN "typeSlug",
ADD COLUMN "type" text  NOT NULL ;

ALTER TABLE "public"."Room" DROP COLUMN "name",
ADD COLUMN "title" text  NOT NULL ;

ALTER TABLE "public"."Tag" DROP COLUMN "name",
ADD COLUMN "title" text  NOT NULL ;

CREATE UNIQUE INDEX "Category_platformId" ON "public"."Category"("platformId")

CREATE UNIQUE INDEX "Platform.type" ON "public"."Platform"("type")

ALTER TABLE "public"."Category" ADD FOREIGN KEY ("platformId")REFERENCES "public"."Platform"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200430150055-init..20200430170330-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,16 +1,16 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("PRISMA_POSTGRES_URL")
 }
 generator client {
   provider = "prisma-client-js"
 }
 generator typegraphql {
   provider = "node_modules/typegraphql-prisma/generator.js"
-  output   = "../src/prisma/generated/type-graphql"
+  output   = "./generated/type-graphql"
 }
 model Country {
   id       String @default(cuid()) @id
@@ -164,24 +164,24 @@
 }
 model Category {
   id         String                 @default(cuid()) @id
-  name       String
+  title      String
   slug       String                 @unique
   type       String
   icon       String
   categoryId String?
   parent     Category?              @relation("ParentCategories", fields: [categoryId], references: [id])
   children   Category[]             @relation("ParentCategories")
   posts      CategoriesOnPosts[]
   products   CategoriesOnProducts[]
-  platformId String
-  platform   Platform               @relation(fields: [platformId], references: [id])
+  platformId String?
+  platform   Platform?              @relation(fields: [platformId], references: [id])
 }
 model Tag {
   id       String           @default(cuid()) @id
-  name     String
+  title    String
   posts    TagsOnPosts[]
   products TagsOnProducts[]
 }
@@ -239,28 +239,28 @@
   BOOKING_DATE
 }
 model Platform {
-  id           String     @default(cuid()) @id
+  id           String    @default(cuid()) @id
   title        String
   link         String
   label        String
   icon         String
   intlId       String
   bannerImg    String
-  typeSlug     String     @unique
+  type         String    @unique
   content      String?
   products     Product[]
-  categories   Category[]
+  category     Category
   platformType String
   countryId    String
-  country      Country    @relation(fields: [countryId], references: [id])
+  country      Country   @relation(fields: [countryId], references: [id])
 }
 model Room {
   id        String    @default(cuid()) @id
   capacity  Int
-  name      String
+  title     String
   productId String
   product   Product   @relation(fields: [productId], references: [id])
   bookings  Booking[]
 }
```


